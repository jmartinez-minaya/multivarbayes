[{"path":"https://jmartinez-minaya.github.io/multivarbayes/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 multivarbayes authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/articles/multivarbayes-vignette.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Multivariate linear regression","text":"vignette demonstrates use multivarbayes package fit Bayesian multivariate linear regression model, summarize results, plot posterior distributions, make predictions new data.","code":""},{"path":[]},{"path":"https://jmartinez-minaya.github.io/multivarbayes/articles/multivarbayes-vignette.html","id":"generate-example-data","dir":"Articles","previous_headings":"Overview","what":"Generate Example Data","title":"Multivariate linear regression","text":"generate example data intercept term multivariate normal errors.","code":"set.seed(123) n <- 1000  # number of observations k <- 3    # number of covariates (including intercept) m <- 2    # number of response variables nsims <- 1000  # Covariate matrix with intercept X <- cbind(1, matrix(rnorm(n * (k - 1)), n, k - 1))    # True coefficients B_true <- matrix(c(1, 0.5, -0.3, 2, -0.5, 1), ncol = m)  # Multivariate normal errors Sigma_true <- matrix(c(1, 0.3, 0.3, 1), ncol = m) errors <- MASS::mvrnorm(n, mu = rep(0, m), Sigma = Sigma_true)  # Response matrix Y <- X %*% B_true + errors    # Combine into data frame data <- data.frame(cbind(Y, X)) colnames(data) <- c(\"Y1\", \"Y2\", \"Intercept\", \"X1\", \"X2\")"},{"path":"https://jmartinez-minaya.github.io/multivarbayes/articles/multivarbayes-vignette.html","id":"fit-the-model","dir":"Articles","previous_headings":"Overview","what":"Fit the Model","title":"Multivariate linear regression","text":"fit model using mlvr function formula interface.","code":"formula <- as.matrix(data[, c(\"Y1\", \"Y2\")]) ~  X1 + X2 model_fit <- mlvr(formula, data = data) model_fit$analytic ## $B_n ##                     Y1         Y2 ## (Intercept)  0.9873563  1.9759494 ## X1           0.4835896 -0.5181053 ## X2          -0.2735044  1.0172392 ##  ## $V_n ##          Y1        Y2 ## Y1 920.5009  277.9382 ## Y2 277.9382 1018.2380 ##  ## $df ## [1] 1003 ##  ## $cov_matrix ##               [,1]          [,2]          [,3]          [,4]          [,5] ## [1,]  9.185982e-04 -1.176349e-05 -3.719340e-05  2.773637e-04 -3.551897e-06 ## [2,] -1.176349e-05  9.401850e-04 -7.978100e-05 -3.551897e-06  2.838817e-04 ## [3,] -3.719340e-05 -7.978100e-05  9.070306e-04 -1.123026e-05 -2.408926e-05 ## [4,]  2.773637e-04 -3.551897e-06 -1.123026e-05  1.016133e-03 -1.301252e-05 ## [5,] -3.551897e-06  2.838817e-04 -2.408926e-05 -1.301252e-05  1.040012e-03 ## [6,] -1.123026e-05 -2.408926e-05  2.738710e-04 -4.114252e-05 -8.825201e-05 ##               [,6] ## [1,] -1.123026e-05 ## [2,] -2.408926e-05 ## [3,]  2.738710e-04 ## [4,] -4.114252e-05 ## [5,] -8.825201e-05 ## [6,]  1.003338e-03"},{"path":"https://jmartinez-minaya.github.io/multivarbayes/articles/multivarbayes-vignette.html","id":"summarize-the-fitted-model","dir":"Articles","previous_headings":"Overview","what":"Summarize the Fitted Model","title":"Multivariate linear regression","text":"can summarize fitted model inspect posterior distributions coefficients scale matrix Sigma.","code":"summary(model_fit) ## ############################################################################### ## ######## <--- Fixed effects parameters (Marginal of B | Y, X): ---> ########### ## ############################################################################### ##  ## Response variable:  Y1  ##                   mean         sd q0.025.2.5%   q0.5.50% q0.975.97.5% ## (Intercept)  0.9882101 0.02944316   0.9335146  0.9878259    1.0473071 ## X1           0.4841381 0.03035238   0.4267144  0.4839449    0.5459440 ## X2          -0.2724936 0.02910453  -0.3279768 -0.2735268   -0.2150985 ##                   mode ## (Intercept)  0.9870151 ## X1           0.4867613 ## X2          -0.2750810 ##  ## Response variable:  Y2  ##                   mean         sd q0.025.2.5%   q0.5.50% q0.975.97.5% ## (Intercept)  1.9750329 0.03313062   1.9085149  1.9748964    2.0390554 ## X1          -0.5182408 0.03037799  -0.5799787 -0.5185471   -0.4579699 ## X2           1.0171430 0.03244027   0.9549307  1.0184422    1.0824680 ##                   mode ## (Intercept)  1.9693254 ## X1          -0.5128016 ## X2           1.0246825 ##  ## ############################################################################### ## ###############  <--- Hyperparameters (Covariance Matrix): ---> ############### ## ############################################################################### ##  ##                mean         sd q0.025.2.5%  q0.5.50% q0.975.97.5%      mode ## sigma2_1  0.9205045 0.04200995   0.8475987 0.9182751    1.0120416 0.9117627 ## sigma2_12 0.2787608 0.03228799   0.2153344 0.2782053    0.3443851 0.2799257 ## sigma2_2  1.0180927 0.04545909   0.9328351 1.0173819    1.1121817 1.0058404"},{"path":"https://jmartinez-minaya.github.io/multivarbayes/articles/multivarbayes-vignette.html","id":"plot-posterior-distributions","dir":"Articles","previous_headings":"Overview","what":"Plot Posterior Distributions","title":"Multivariate linear regression","text":"visualize posterior distributions coefficients, can use plot method.","code":"plot(model_fit) ## $fixed_effects_plot ##  ## $hyperparameter_plot summary(model_fit) ## ############################################################################### ## ######## <--- Fixed effects parameters (Marginal of B | Y, X): ---> ########### ## ############################################################################### ##  ## Response variable:  Y1  ##                   mean         sd q0.025.2.5%   q0.5.50% q0.975.97.5% ## (Intercept)  0.9882101 0.02944316   0.9335146  0.9878259    1.0473071 ## X1           0.4841381 0.03035238   0.4267144  0.4839449    0.5459440 ## X2          -0.2724936 0.02910453  -0.3279768 -0.2735268   -0.2150985 ##                   mode ## (Intercept)  0.9870151 ## X1           0.4867613 ## X2          -0.2750810 ##  ## Response variable:  Y2  ##                   mean         sd q0.025.2.5%   q0.5.50% q0.975.97.5% ## (Intercept)  1.9750329 0.03313062   1.9085149  1.9748964    2.0390554 ## X1          -0.5182408 0.03037799  -0.5799787 -0.5185471   -0.4579699 ## X2           1.0171430 0.03244027   0.9549307  1.0184422    1.0824680 ##                   mode ## (Intercept)  1.9693254 ## X1          -0.5128016 ## X2           1.0246825 ##  ## ############################################################################### ## ###############  <--- Hyperparameters (Covariance Matrix): ---> ############### ## ############################################################################### ##  ##                mean         sd q0.025.2.5%  q0.5.50% q0.975.97.5%      mode ## sigma2_1  0.9205045 0.04200995   0.8475987 0.9182751    1.0120416 0.9117627 ## sigma2_12 0.2787608 0.03228799   0.2153344 0.2782053    0.3443851 0.2799257 ## sigma2_2  1.0180927 0.04545909   0.9328351 1.0173819    1.1121817 1.0058404 B_true ##      [,1] [,2] ## [1,]  1.0  2.0 ## [2,]  0.5 -0.5 ## [3,] -0.3  1.0"},{"path":"https://jmartinez-minaya.github.io/multivarbayes/articles/multivarbayes-vignette.html","id":"predict-new-observations","dir":"Articles","previous_headings":"Overview","what":"Predict New Observations","title":"Multivariate linear regression","text":"Finally, can use predict function predict responses new observations based fitted model. final part, compare theoretical predictive distribution simulated predictive distribution, well actual observed values. allows us visually inspect well model captures underlying data distribution uncertainty associated .","code":"# Example usage: # Assuming model_fit is the fitted object and newdata is the new data to predict on newdata <- data.frame(X1 = c(0.5, -1, 2), X2 = c(-0.5, 1.5, 0))  # New covariate values newdata <- data[1:5, c(\"X1\", \"X2\")] newdata_real <- data[1:5, c(\"Y1\", \"Y2\")]  predictions <- predict(model_fit, newdata = newdata) #cat(\"--- Y1 --- \\n\") predictions$summary$Y1 %>% round(.,3) ##    mean    sd lower_2.5 median upper_97.5 ## 1 0.989 0.959    -0.891  0.989      2.868 ## 2 1.160 0.959    -0.719  1.160      3.040 ## 3 1.746 0.959    -0.134  1.746      3.627 ## 4 1.058 0.958    -0.821  1.058      2.936 ## 5 1.747 0.962    -0.138  1.747      3.632 #cat(\"--- Y2 --- \\n\") predictions$summary$Y2 %>% round(., 3) ##     mean    sd lower_2.5 median upper_97.5 ## 1  1.253 1.009    -0.724  1.253      3.230 ## 2  1.037 1.009    -0.940  1.037      3.014 ## 3  1.150 1.009    -0.828  1.150      3.128 ## 4  1.805 1.008    -0.171  1.805      3.781 ## 5 -0.684 1.011    -2.667 -0.684      1.298 # Suppose `predictions` is the object containing the results obtained from the `predict.mlvr` function # and `newdata_real` holds the actual values for each predicted individual. # Extract necessary elements from predictions analytic_mean <- predictions$analytic$mean          # Theoretical predictive mean analytic_cov <- predictions$analytic$cov_matrix     # Theoretical predictive covariance predictive_samples <- predictions$marginals         # Simulated predictive samples df <- predictions$analytic$df                       # Degrees of freedom for the t-Student distribution newdata_real <- newdata_real                        # Actual values provided  # Create a data frame to store simulated predictive samples simulated_data <- data.frame() n_obs <- nrow(analytic_mean)                        # Number of observations in newdata n_sims <- ncol(predictive_samples[[1]])             # Number of simulations (assume all responses have the same number of simulations) n_responses <- length(predictive_samples)           # Number of response variables  # Build the data frame for simulated predictive samples for (resp in 1:n_responses) {   for (obs in 1:n_obs) {     sim_values <- predictive_samples[[resp]][obs, ]  # Simulated samples for the response variable and observation     sim_df <- data.frame(       Observation = paste0(\"Obs_\", obs),             # Observation label       Response = paste0(\"Y\", resp),                  # Response variable name       Value = sim_values,                            # Simulated samples       Group = \"Simulated\"                            # Group label     )     simulated_data <- rbind(simulated_data, sim_df)   } }  # Create a data frame for theoretical densities theoretical_data <- data.frame()  # Calculate theoretical density for each observation and response variable for (obs in 1:n_obs) {   for (resp in 1:n_responses) {     mean_val <- analytic_mean[obs, resp]          # Theoretical mean for the response variable     var_val <- analytic_cov[resp, resp, obs]      # Variance for the response variable          # Create a sequence of values to represent the theoretical density     x_vals <- seq(mean_val - 4 * sqrt(var_val), mean_val + 4 * sqrt(var_val), length.out = 500)          # Calculate density using the t-Student distribution     dens_vals <- dt((x_vals - mean_val) / sqrt(var_val), df = df) / sqrt(var_val)          # Create a data frame to store theoretical densities     theor_df <- data.frame(       Observation = paste0(\"Obs_\", obs),       Response = paste0(\"Y\", resp),       Value = x_vals,       Density = dens_vals,       Group = \"Theoretical\"     )     theoretical_data <- rbind(theoretical_data, theor_df)   } }  # Create a data frame for the actual observed values real_values_data <- data.frame(   Observation = rep(paste0(\"Obs_\", 1:n_obs), each = n_responses),  # Labeled observations   Response = rep(paste0(\"Y\", 1:n_responses), times = n_obs),       # Response variable name   Value = as.vector(t(newdata_real)),                              # Convert actual values to a vector   Group = \"Real\"                                                   # Group label for \"Real\" )  # Convert simulated data to densities for plotting simulated_densities <- simulated_data %>%   group_by(Observation, Response) %>%   do({     density_data <- density(.$Value, adjust = 1.2)  # Calculate density for simulated samples     data.frame(Value = density_data$x, Density = density_data$y)  # Store density values   }) %>%   ungroup() %>%   mutate(Group = \"Simulated\")  # Label as \"Simulated\" for plotting  # Combine theoretical and simulated densities into a single data frame plot_data <- rbind(simulated_densities, theoretical_data)  # Create plots ggplot() +   # Histograms for simulated predictive samples   geom_line(data = simulated_densities, aes(x = Value, y = Density, color = Group), size = 1.2) +   # Line for theoretical densities   geom_line(data = theoretical_data, aes(x = Value, y = Density, color = Group), linetype = \"dashed\", size = 1.2) +   # Vertical line for actual observed values   geom_vline(data = real_values_data, aes(xintercept = Value, color = Group), linetype = \"dotted\", size = 1.2) +   facet_grid(Response ~ Observation, scales = \"free\") +  # Facets by response and observation   labs(title = \"Predictive Distributions for Each Observation\",        x = \"Value\",        y = \"Density\") +   theme_minimal() +   theme(legend.position = \"top\", legend.title = element_text(face = \"bold\")) +   scale_color_manual(values = c(\"blue\", \"red\", \"green\")) +   # Colors for distributions and actual values   guides(color = guide_legend(title = \"Distribution Types\"))"},{"path":"https://jmartinez-minaya.github.io/multivarbayes/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Joaquín Martínez-Minaya. Author, maintainer, contributor.","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Joaquín Martínez-Minaya (2024). multivarbayes: Multivariate Bayesian Model. R package version 0.1, https://jmartinez-minaya.github.io/multivarbayes/.","code":"@Manual{,   title = {multivarbayes: Multivariate Bayesian Model},   author = {{Joaquín Martínez-Minaya}},   year = {2024},   note = {R package version 0.1},   url = {https://jmartinez-minaya.github.io/multivarbayes/}, }"},{"path":"https://jmartinez-minaya.github.io/multivarbayes/index.html","id":"multivarbayes","dir":"","previous_headings":"","what":"Multivariate Bayesian Model","title":"Multivariate Bayesian Model","text":"goal multivarbayes fit Bayesian multivariate linear regression models using conjugate priors. package allows users specify prior distributions use default settings natural conjugate priors. model supports simulation-based posterior inference regression coefficients covariance structure residuals.","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/index.html","id":"key-features","dir":"","previous_headings":"","what":"Key features","title":"Multivariate Bayesian Model","text":"Supports conjugate Bayesian multivariate linear regression. Simulates posterior distributions regression coefficients covariance matrices. Computes analytical simulated posterior predictive distributions. Includes summary visualization functions posterior distributions.","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Multivariate Bayesian Model","text":"multivarbayes yet available CRAN. can install development version GitHub :","code":"# Install the development version from GitHub remotes::install_github(\"jmartinez-minaya/multivarbayes\")"},{"path":"https://jmartinez-minaya.github.io/multivarbayes/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Multivariate Bayesian Model","text":"basic example fit multivariate linear model using multivarbayes summarize results:","code":"library(multivarbayes) set.seed(123) n <- 1000  # number of observations k <- 3    # number of covariates (including intercept) m <- 2    # number of response variables nsims <- 1000  # Covariate matrix with intercept X <- cbind(1, matrix(rnorm(n * (k - 1)), n, k - 1))    # True coefficients B_true <- matrix(c(1, 0.5, -0.3, 2, -0.5, 1), ncol = m)  # Multivariate normal errors Sigma_true <- matrix(c(1, 0.3, 0.3, 1), ncol = m) errors <- MASS::mvrnorm(n, mu = rep(0, m), Sigma = Sigma_true)  # Response matrix Y <- X %*% B_true + errors    # Combine into data frame data <- data.frame(cbind(Y, X)) colnames(data) <- c(\"Y1\", \"Y2\", \"Intercept\", \"X1\", \"X2\")   # Fit the Bayesian multivariate linear model formula <- as.matrix(data[, c(\"Y1\", \"Y2\")]) ~  X1 + X2 model_fit <- mlvr(formula, data = data)  # Summarize the fitted model summary(model_fit)  # Plot posterior distributions plot(model_fit)"},{"path":"https://jmartinez-minaya.github.io/multivarbayes/index.html","id":"additional-resources","dir":"","previous_headings":"","what":"Additional Resources","title":"Multivariate Bayesian Model","text":"detailed tutorial fitting Bayesian multivariate linear regression model, check vignette: Link vignette","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/index.html","id":"references","dir":"","previous_headings":"Additional Resources","what":"References","title":"Multivariate Bayesian Model","text":"underlying methodology based standard Bayesian multivariate linear regression models, posterior inference carried using conjugate priors regression coefficients covariance structure residuals. Gelman, ., Carlin, J. B., Stern, H. S., & Rubin, D. B. (1995). Bayesian data analysis. Chapman Hall/CRC. Rossi, P. E., & Allenby, G. M. (2003). Bayesian statistics marketing. Marketing Science, 22(3), 304-328.","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/index.html","id":"issues","dir":"","previous_headings":"Additional Resources","what":"Issues","title":"Multivariate Bayesian Model","text":"encounter problems suggestions improvements, please open issue.","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/format_marginals_fixed.html","id":null,"dir":"Reference","previous_headings":"","what":"Format Marginals for Fixed Effects — format_marginals_fixed","title":"Format Marginals for Fixed Effects — format_marginals_fixed","text":"function formats posterior simulations fixed effects list data frames, one response variable.","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/format_marginals_fixed.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format Marginals for Fixed Effects — format_marginals_fixed","text":"","code":"format_marginals_fixed(B_sims, X, Y)"},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/format_marginals_fixed.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Format Marginals for Fixed Effects — format_marginals_fixed","text":"B_sims 3D array containing posterior simulations fixed effects. X Matrix covariates (predictors) used model. Y Matrix response variables.","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/format_marginals_fixed.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Format Marginals for Fixed Effects — format_marginals_fixed","text":"list data frames response variable.","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/format_marginals_fixed.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Format Marginals for Fixed Effects — format_marginals_fixed","text":"Joaquín Martínez-Minaya jmarmin@eio.upv.es","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/format_marginals_random.html","id":null,"dir":"Reference","previous_headings":"","what":"Format Marginals for Random Effects (Hyperparameters) — format_marginals_random","title":"Format Marginals for Random Effects (Hyperparameters) — format_marginals_random","text":"function formats posterior simulations hyperparameters (covariance matrix) single data frame, including diagonal upper-triangle elements.","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/format_marginals_random.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format Marginals for Random Effects (Hyperparameters) — format_marginals_random","text":"","code":"format_marginals_random(Sigma_sims)"},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/format_marginals_random.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Format Marginals for Random Effects (Hyperparameters) — format_marginals_random","text":"Sigma_sims 3D array containing posterior simulations covariance matrix.","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/format_marginals_random.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Format Marginals for Random Effects (Hyperparameters) — format_marginals_random","text":"data frame rows simulations columns elements covariance matrix.","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/format_marginals_random.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Format Marginals for Random Effects (Hyperparameters) — format_marginals_random","text":"Joaquín Martínez-Minaya jmarmin@eio.upv.es","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/mlvr.html","id":null,"dir":"Reference","previous_headings":"","what":"Main function to fit the Bayesian Multivariate Linear Model — mlvr","title":"Main function to fit the Bayesian Multivariate Linear Model — mlvr","text":"function fits Bayesian multivariate linear regression model using conjugate priors returns detailed output, including summaries simulations fixed effects hyperparameters, well analytic posterior distributions.","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/mlvr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Main function to fit the Bayesian Multivariate Linear Model — mlvr","text":"","code":"mlvr(formula, data, priors = list(), n_sims = 1000)"},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/mlvr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Main function to fit the Bayesian Multivariate Linear Model — mlvr","text":"formula Formula specify model. data data frame containing covariates response variables. priors list specifying prior parameters. Default `list()`. n_sims Number posterior simulations. Default 1000.","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/mlvr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Main function to fit the Bayesian Multivariate Linear Model — mlvr","text":"list containing summaries, simulations fixed effects hyperparameters, analytic posterior distributions.","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/mlvr.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Main function to fit the Bayesian Multivariate Linear Model — mlvr","text":"## Model Priors: model assumes multivariate normal distribution response variables: $$Y = XB + E$$ \\(Y\\) matrix response variables, \\(X\\) matrix covariates, \\(B\\) matrix coefficients, \\(E\\) error matrix. following prior distributions used: - \\(B\\) | \\(\\Sigma\\) follows matrix-variate normal distribution:   $$B | \\Sigma \\sim \\mathcal{N}(B_0, \\Sigma \\otimes ^{-1})$$ - \\(\\Sigma\\) follows inverse-Wishart distribution:   $$\\Sigma \\sim \\text{IW}(\\nu_0, V_0)$$ ## Posterior Distributions: - posterior \\(B\\) given \\(\\Sigma\\) :   $$B | \\Sigma, Y, X \\sim \\mathcal{N}(B_n, \\Sigma \\otimes (X'X + )^{-1})$$ - marginal posterior \\(\\Sigma\\) given \\(Y, X\\) :   $$\\Sigma | Y, X \\sim \\text{IW}(\\nu_0 + n, V_0 + S)$$ analytic forms posterior parameters computed follows: - \\(B_n = (X'X + )^{-1}(X'Y + B_0)\\) - \\(V_n = V_0 + S\\), \\(S = (Y - X B_n)'(Y - X B_n) + (B_n - B_0)' (B_n - B_0)\\) ## Output: function returns list containing: - `summary.fixed`: summary marginal posterior distributions fixed effects. - `marginals.fixed`: list simulations fixed effects. - `summary.hyperpar`: summary posterior distributions hyperparameters (elements \\(\\Sigma\\)). - `marginals.hyperpar`: list simulations hyperparameters. - `analytic`: list containing following analytic posterior parameters:   - `B_n`: posterior mean coefficient matrix \\(B\\), calculated \\((X'X + )^{-1}(X'Y + B_0)\\).   - `V_n`: posterior scale matrix inverse-Wishart distribution \\(\\Sigma\\), given \\(V_0 + S\\).   - `df`: degrees freedom marginal posterior distribution \\(\\Sigma\\), equal \\(\\nu_0 + n - m + 1\\).   - `cov_matrix`: covariance matrix marginal posterior distribution \\(B | X, Y\\), computed \\(V_n / \\text{df} \\otimes (X'X + )^{-1}\\). - ``: precision matrix used \\(B\\). - `formula`: formula specifying model. - `X`: design matrix covariates. - `Y`: response matrix. - `call`: original function call. ## Details: analytic posterior distributions computed using following theoretical results: - posterior distribution coefficient matrix \\(B\\) derived using matrix-variate normal distribution: $$B | \\Sigma, Y, X \\sim \\mathcal{N}(B_n, \\Sigma \\otimes (X'X + )^{-1})$$ \\(B_n\\) posterior mean \\(\\Sigma \\otimes (X'X + )^{-1}\\) Kronecker product covariance matrix \\(\\Sigma\\) precision matrix covariates. - posterior distribution covariance matrix \\(\\Sigma\\) follows inverse-Wishart distribution: $$\\Sigma | Y, X \\sim \\text{IW}(\\nu_0 + n, V_0 + S)$$ \\(S\\) sum squared residuals deviation \\(B_n\\) prior mean \\(B_0\\).","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/mlvr.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Main function to fit the Bayesian Multivariate Linear Model — mlvr","text":"Joaquín Martínez-Minaya jmarmin@eio.upv.es","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/mlvr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Main function to fit the Bayesian Multivariate Linear Model — mlvr","text":"","code":"if (FALSE) { # \\dontrun{ data <- data.frame(X1 = rnorm(100), X2 = rnorm(100), Y1 = rnorm(100), Y2 = rnorm(100)) formula <- as.matrix(data[, c(\"Y1\", \"Y2\")]) ~ X1 + X2 fit <- mlvr(formula, data) summary(fit) plot(fit) } # }"},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/plot.mlvr.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Posterior Distributions for a Bayesian Multivariate Linear Model — plot.mlvr","title":"Plot Posterior Distributions for a Bayesian Multivariate Linear Model — plot.mlvr","text":"function generates density plots posterior distributions fixed effects hyperparameters fitted Bayesian multivariate linear model.","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/plot.mlvr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Posterior Distributions for a Bayesian Multivariate Linear Model — plot.mlvr","text":"","code":"# S3 method for class 'mlvr' plot(x, ...)"},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/plot.mlvr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Posterior Distributions for a Bayesian Multivariate Linear Model — plot.mlvr","text":"x object class `mlvr` containing posterior simulations model. ... Additional arguments (currently unused).","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/plot.mlvr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Posterior Distributions for a Bayesian Multivariate Linear Model — plot.mlvr","text":"list ggplot objects: one fixed effects one hyperparameters.","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/predict.mlvr.html","id":null,"dir":"Reference","previous_headings":"","what":"Predictive Distribution for Bayesian Multivariate Linear Model (Analytical and Simulated) — predict.mlvr","title":"Predictive Distribution for Bayesian Multivariate Linear Model (Analytical and Simulated) — predict.mlvr","text":"function generates analytical simulated predictive distributions new data based fitted Bayesian multivariate linear model.","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/predict.mlvr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predictive Distribution for Bayesian Multivariate Linear Model (Analytical and Simulated) — predict.mlvr","text":"","code":"# S3 method for class 'mlvr' predict(object, newdata, n_sims = 1000)"},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/predict.mlvr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predictive Distribution for Bayesian Multivariate Linear Model (Analytical and Simulated) — predict.mlvr","text":"object object class `mlvr` containing posterior simulations model. newdata data frame containing new observations predictions made. n_sims Number predictive simulations (optional, default 1000).","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/predict.mlvr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predictive Distribution for Bayesian Multivariate Linear Model (Analytical and Simulated) — predict.mlvr","text":"list containing summaries, analytical simulated predictive distributions, marginals.","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/predict.mlvr.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Predictive Distribution for Bayesian Multivariate Linear Model (Analytical and Simulated) — predict.mlvr","text":"Joaquín Martínez-Minaya jmarmin@eio.upv.es","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/summarize_fixed_effects.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize Fixed Effects for Bayesian Multivariate Linear Model — summarize_fixed_effects","title":"Summarize Fixed Effects for Bayesian Multivariate Linear Model — summarize_fixed_effects","text":"function summarizes fixed effects (marginal B | Y, X) posterior simulations.","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/summarize_fixed_effects.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize Fixed Effects for Bayesian Multivariate Linear Model — summarize_fixed_effects","text":"","code":"summarize_fixed_effects(B_sims, X, Y)"},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/summarize_fixed_effects.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize Fixed Effects for Bayesian Multivariate Linear Model — summarize_fixed_effects","text":"B_sims 3D array containing posterior simulations fixed effects. X Matrix covariates (predictors) used model. Y Matrix response variables.","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/summarize_fixed_effects.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize Fixed Effects for Bayesian Multivariate Linear Model — summarize_fixed_effects","text":"summary fixed effects (mean, sd, quantiles) predictor response variable.","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/summarize_fixed_effects.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Summarize Fixed Effects for Bayesian Multivariate Linear Model — summarize_fixed_effects","text":"Joaquín Martínez-Minaya jmarmin@eio.upv.es","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/summarize_hyperparameters.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize Hyperparameters for Bayesian Multivariate Linear Model — summarize_hyperparameters","title":"Summarize Hyperparameters for Bayesian Multivariate Linear Model — summarize_hyperparameters","text":"function summarizes hyperparameters (covariance matrix elements) posterior simulations.","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/summarize_hyperparameters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize Hyperparameters for Bayesian Multivariate Linear Model — summarize_hyperparameters","text":"","code":"summarize_hyperparameters(Sigma_sims)"},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/summarize_hyperparameters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize Hyperparameters for Bayesian Multivariate Linear Model — summarize_hyperparameters","text":"Sigma_sims 3D array containing posterior simulations covariance matrix.","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/summarize_hyperparameters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize Hyperparameters for Bayesian Multivariate Linear Model — summarize_hyperparameters","text":"summary hyperparameters (mean, sd, quantiles) element covariance matrix.","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/summarize_hyperparameters.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Summarize Hyperparameters for Bayesian Multivariate Linear Model — summarize_hyperparameters","text":"Joaquín Martínez-Minaya jmarmin@eio.upv.es","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/summary.mlvr.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary of a Bayesian Multivariate Linear Model — summary.mlvr","title":"Summary of a Bayesian Multivariate Linear Model — summary.mlvr","text":"function provides summary fitted Bayesian multivariate linear model. includes summaries marginal conditional posterior distributions B, well summaries hyperparameters (covariance matrix).","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/summary.mlvr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary of a Bayesian Multivariate Linear Model — summary.mlvr","text":"","code":"# S3 method for class 'mlvr' summary(object, ...)"},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/summary.mlvr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary of a Bayesian Multivariate Linear Model — summary.mlvr","text":"object object class mlvr, containing posterior simulations model. ... Additional arguments (currently unused).","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/summary.mlvr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary of a Bayesian Multivariate Linear Model — summary.mlvr","text":"printed summary model fit.","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/summary.mlvr.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Summary of a Bayesian Multivariate Linear Model — summary.mlvr","text":"Joaquín Martínez-Minaya jmarmin@eio.upv.es","code":""},{"path":"https://jmartinez-minaya.github.io/multivarbayes/reference/summary.mlvr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summary of a Bayesian Multivariate Linear Model — summary.mlvr","text":"","code":"if (FALSE) { # \\dontrun{ summary(fit)  # Summarize the fitted model } # }"}]
